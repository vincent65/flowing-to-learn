# FCLF Configuration
# Flow-based Contrastive Learning for Facial Attribute Classification

model:
  embedding_dim: 512      # CLIP ViT-B/32 embedding dimension
  num_attributes: 5       # Number of binary attributes
  hidden_dim: 256         # MLP hidden layer size
  projection_radius: 1.0  # Unit sphere constraint

training:
  num_epochs: 50
  batch_size: 512
  learning_rate: 0.0001   # 1e-4
  alpha: 0.1              # Flow step size

loss:
  # Note: Ablation study found tau=0.5 gives best cluster separation
  # Use tau=0.5 for optimal results, tau=0.1 is the baseline
  temperature: 0.1        # Contrastive temperature (try 0.5 for better results)
  lambda_contrastive: 0.7 # Contrastive loss weight
  lambda_identity: 0.3    # Identity preservation weight
  lambda_curl: 0.01       # Vector field curl regularization
  lambda_div: 0.01        # Vector field divergence regularization

inference:
  num_flow_steps: 10      # Number of Euler integration steps
  step_size: 0.1          # Should match training alpha

ablation:
  use_contrastive: true   # Critical: removing drops accuracy by 8%
  use_curl: true          # Optional: minimal impact
  use_div: true           # Optional: minimal impact
  use_label_condition: true  # Critical: removing drops accuracy by 7%
